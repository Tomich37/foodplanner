{% extends "base.html" %}

{% block title %}Админ · Дополнительные теги{% endblock %}

{% block content %}
<section class="admin-tags">
    <div class="container">
        <div class="admin-nav">
            <a href="{{ url_for('admin_users') }}" class="admin-nav__link">Пользователи</a>
            <a href="{{ url_for('admin_tags') }}" class="admin-nav__link admin-nav__link--active">Теги</a>
        </div>
        <div class="admin-tags__header">
            <div>
                <p class="eyebrow">Управление каталогом</p>
                <h1>Дополнительные теги рецептов</h1>
                <p class="admin-tags__subtitle">
                    Здесь можно добавлять новые фильтры для рецептов и удалять устаревшие. Эти теги отображаются в
                    выпадающем списке на странице рецептов и в форме создания блюда.
                </p>
            </div>
            <div class="stat-card">
                <div class="stat-card__label">Всего тегов</div>
                <div class="stat-card__value">{{ tags|length }}</div>
            </div>
        </div>

        <div class="admin-tags__grid">
            <div class="admin-tags__card">
                <h2>Добавить тег</h2>
                <p class="admin-tags__hint">
                    Ключ используется в ссылках и должен содержать только латиницу, цифры и знак дефиса.
                    Если оставить поле пустым, он будет сгенерирован из названия.
                </p>
                {% if form_error %}
                <div class="form-error">{{ form_error }}</div>
                {% endif %}
                <form method="post" action="{{ url_for('admin_create_tag') }}" class="admin-tags__form">
                    <label for="tag-label">Название</label>
                    <input
                        type="text"
                        id="tag-label"
                        name="label"
                        required
                        maxlength="100"
                        placeholder="Например, Полезные перекусы"
                    />
                    <label for="tag-value">Ключ (опционально)</label>
                    <input
                        type="text"
                        id="tag-value"
                        name="value"
                        maxlength="32"
                        placeholder="Например, healthy-snack"
                    />
                    <button type="submit" class="btn btn--primary">Создать тег</button>
                </form>
            </div>

            <div class="admin-tags__card">
                <h2>Список тегов</h2>
                {% if tags %}
                <div class="admin-tags__list">
                    {% for tag in tags %}
                    <article class="tag-row">
                        <div>
                            <div class="tag-row__label">{{ tag.label }}</div>
                            <div class="tag-row__meta">
                                Ключ: <span>{{ tag.value }}</span>
                                {% if tag.created_at %}· Создан: {{ tag.created_at.strftime('%d.%m.%Y') }}{% endif %}
                            </div>
                        </div>
                        <form
                            method="post"
                            action="{{ url_for('admin_delete_tag', tag_id=tag.id) }}"
                            onsubmit="return confirm('Вы уверены, что хотите удалить тег «{{ tag.label }}»?')"
                        >
                            <button type="submit" class="btn btn--ghost btn--danger btn--small">Удалить</button>
                        </form>
                    </article>
                    {% endfor %}
                </div>
                {% else %}
                <p class="admin-tags__empty">
                    Пока нет ни одного дополнительного тега. Добавьте первый, чтобы пользователи могли фильтровать
                    рецепты по новым признакам.
                </p>
                {% endif %}
            </div>
        </div>
    </div>
</section>
{% endblock %}

{% block extra_styles %}
<link rel="stylesheet" href="{{ url_for('static', path='/css/pages/admin_tags.css') }}" />
{% endblock %}
